{"version":3,"sources":["../src/index.js"],"names":["LEFT","RIGHT","matches","openPath","path","i","length","stopPropagation","e","MultiMenuWrapper","props","handleHover","setState","state","align","expandDirection","isSubMenu","menu","onSelect","position","defaultProps","MultiMenu","basePath","onHover","map","itm","concat","MenuItem","handleClick","value","data","open","hasChildren","children","label","MultiMenuTrigger","expanded","element","rect","getBoundingClientRect","windowWidth","window","innerWidth","center","left","right","top","bottom","handleSelect","val","handleClickOutside","elementRef","el","addEventListener","removeEventListener"],"mappings":"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","file":"index.js","sourcesContent":["import React, { Component } from 'react'\nimport classNames from 'classnames'\n\nconst LEFT = 'left'\nconst RIGHT = 'right'\n\nexport const matches = (openPath, path) => {\n  for (let i = 0; i < path.length; i += 1) {\n    if (openPath[i] !== path[i]) {\n      return false\n    }\n  }\n\n  return true\n}\n\nconst stopPropagation = e => {\n  e.stopPropagation()\n}\n\nexport default class MultiMenuWrapper extends Component {\n  static defaultProps = {\n    expandDirection: RIGHT\n  }\n\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      openPath: []\n    }\n  }\n\n  handleHover = openPath => {\n    this.setState({ openPath })\n  }\n\n  render() {\n    let {\n      align,\n      expandDirection,\n      isSubMenu,\n      menu,\n      onSelect,\n      position\n    } = this.props\n\n    let { openPath } = this.state\n\n    return (\n      <div\n        className={classNames(\n          'multi-menu-wrapper',\n          `expand-${expandDirection}`\n        )}\n        style={position}\n      >\n        <MultiMenu\n          {...{ isSubMenu, onSelect }}\n          basePath={[]}\n          menu={menu}\n          openPath={openPath}\n          onHover={this.handleHover}\n        />\n      </div>\n    )\n  }\n}\n\nexport class MultiMenu extends Component {\n  render() {\n    let {\n      basePath,\n      isSubMenu,\n      menu,\n      onHover,\n      onSelect,\n      openPath,\n    } = this.props\n\n    return (\n      <div className=\"multi-menu\">\n        {menu.map((itm, i) => (\n          <MenuItem\n            key={i}\n            data={itm}\n            onHover={onHover}\n            onSelect={onSelect}\n            openPath={openPath}\n            path={basePath.concat([i])}\n          />\n        ))}\n      </div>\n    )\n  }\n}\n\nexport class MenuItem extends Component {\n  handleClick = e => {\n    let { data: { value }, onSelect } = this.props\n\n    if (!onSelect) { return }\n\n    onSelect(value)\n  }\n\n  handleHover = e => {\n    let { path, onHover } = this.props\n\n    e.stopPropagation()\n\n    onHover(path)\n  }\n\n  render() {\n    let { data, path, onHover, onSelect, openPath } = this.props\n\n    let open = matches(openPath, path)\n    let hasChildren = data.children && data.children.length > 0\n\n    return (\n      <div\n        className={classNames(\n          'multi-menu-item',\n          { open, 'has-children': hasChildren }\n        )}\n        onMouseOver={this.handleHover}\n      >\n        <div\n          className=\"multi-menu-item-label\"\n          onClick={this.handleClick}\n          title={data.label}\n        >\n          {data.label}\n        </div>\n        {open && hasChildren\n          ? <div\n              className=\"multi-menu-child\"\n              onMouseOver={stopPropagation}\n            >\n              <MultiMenu\n                basePath={path}\n                menu={data.children}\n                onHover={onHover}\n                onSelect={onSelect}\n                openPath={openPath}\n              />\n            </div>\n          : null}\n      </div>\n    )\n  }\n}\n\nexport class MultiMenuTrigger extends Component {\n  state = { expanded: false, position: null, expandDirection: null }\n\n  handleClick = e => {\n    if (this.state.expanded) {\n      return this.setState({ expanded: false })\n    }\n\n    let position = this.state.position\n    let expandDirection = RIGHT\n\n    if (this.element) {\n      let rect = this.element.getBoundingClientRect()\n      let windowWidth = window.innerWidth\n\n      let center = (rect.left + rect.right) / 2\n\n      if (center * 2 > windowWidth) {\n        expandDirection = LEFT\n      }\n\n      position = { top: rect.bottom + 8 }\n\n      if (center - 90 < 20) {\n        position.left = rect.left\n      } else if (center + 90 > windowWidth - 20) {\n        position.left = rect.right - 180\n      } else {\n        position.left = center - 90\n      }\n    }\n\n    this.setState({ position, expandDirection, expanded: true })\n  }\n\n  handleSelect = val => {\n    let { onSelect } = this.props\n\n    this.setState({ expanded: false })\n\n    if (onSelect) {\n      onSelect(val)\n    }\n  }\n\n  handleClickOutside = e => {\n    this.setState({ expanded: false })\n  }\n\n  componentDidMount() {\n    window.addEventListener('mousedown', this.handleClickOutside)\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('mousedown', this.handleClickOutside)\n  }\n\n  elementRef = el => this.element = el\n\n  render() {\n    let { children, menu } = this.props\n    let { expandDirection, expanded, position } = this.state\n\n    return (\n      <div\n        className={classNames('multi-menu-trigger', { expanded })}\n        onMouseDown={stopPropagation}\n        ref={this.elementRef}\n      >\n        {expanded\n          ? <MultiMenuWrapper\n              expandDirection={expandDirection}\n              menu={menu}\n              onSelect={this.handleSelect}\n              position={position}\n            />\n          : null}\n        <div className=\"multi-menu-trigger-element\" onClick={this.handleClick}>\n          {children}\n        </div>\n      </div>\n    )\n  }\n}\n"]}